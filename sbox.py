def sbox_lookup(bits):
    sbox = [
        # S-box decimal
        [14, 4, 13, 1, 2, 15, 11, 8, 3, 10, 6, 12, 5, 9, 0, 7],
        [0, 15, 7, 4, 14, 2, 13, 1, 10, 6, 12, 11, 9, 5, 3, 8],
        [4, 1, 14, 8, 13, 6, 2, 11, 15, 12, 9, 7, 3, 10, 5, 0],
        [15, 12, 8, 2, 4, 9, 1, 7, 5, 11, 3, 14, 10, 0, 6, 13],
    ]
    row = int(bits[0] + bits[5], 2)
    col = int(bits[1:5], 2)
    return sbox[row][col]

def sbox_lookup_bin(bits):
    sbox = [
        # S-box values
        ['1110', '0100', '1101', '0001', '0010', '1111', '1011', '1000',
         '0011', '1010', '0110', '1100', '0101', '1001', '0000', '0111'],
        ['0000', '1111', '0111', '0100', '1110', '0010', '1101', '0001',
         '1010', '0110', '1100', '1011', '1001', '0101', '0011', '1000'],
        ['0100', '0001', '1110', '1000', '1101', '0110', '0010', '1011',
         '1111', '1100', '1001', '0111', '0011', '1010', '0101', '0000'],
        ['1111', '1100', '1000', '0010', '0100', '1001', '0001', '0111',
         '0101', '1011', '0011', '1110', '1010', '0000', '0110', '1101'],
    ]
    row = int(bits[0] + bits[5], 2)
    col = int(bits[1:5], 2)
    return int(sbox[row][col], 2)